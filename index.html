<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>בודק ומעצב JSON</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <h1 class="title">בודק ומעצב JSON</h1>
        </header>
        <main class="main-content">
            <div class="editor-pane">
                 <div class="editor-toolbar">
                    <button id="manage-schemas-btn" class="action-button manage-button" title="נהל סכמות" aria-label="Manage Schemas">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 1.25rem; height: 1.25rem;">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75" />
                        </svg>
                        <span>נהל סכמות</span>
                    </button>
                    <div class="toolbar-main-actions">
                        <select id="schema-validator-select" class="action-button schema-select" title="בחר סוג אימות" aria-label="Select schema validation type">
                            <option value="">בחר סוג</option>
                        </select>
                        <button id="load-file-btn" class="action-button load-button" title="טען קובץ JSON מהמחשב" aria-label="Load JSON file">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 1.25rem; height: 1.25rem;">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"></path>
                            </svg>
                            <span>טען קובץ</span>
                        </button>
                        <button id="minify-btn" class="action-button minify-button" title="כווץ את ה-JSON לשורה אחת" aria-label="Minify JSON">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 1.25rem; height: 1.25rem;">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5M15 15l5.25 5.25" />
                            </svg>
                            <span>כווץ</span>
                        </button>
                        <button id="beautify-btn" class="action-button beautify-button" title="יפה לי את ה-JSON" aria-label="Format JSON">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6" style="width:1.25rem; height:1.25rem;">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456Z"></path>
                            </svg>
                           <span>יפה לי</span>
                        </button>
                    </div>
                </div>
                <div class="editor-container">
                    <div id="line-numbers" class="line-numbers" aria-hidden="true"><div>1</div></div>
                    <textarea id="json-input" class="json-textarea" dir="ltr" placeholder='{ "paste": "your JSON here" }' spellcheck="false" aria-label="JSON Input" wrap="off"></textarea>
                </div>
                <div id="schema-feedback" class="feedback-display" hidden>
                    <div id="schema-feedback-icon"></div>
                    <p id="schema-feedback-message"></p>
                </div>
                <div id="error-display" class="error-display" hidden>
                    <div id="error-icon"></div>
                    <p id="error-message"></p>
                </div>
            </div>
            <div id="resizer" class="resizer" role="separator" aria-label="Resize panes"></div>
            <div class="tree-pane">
                <h2 class="pane-title">תצוגת עץ</h2>
                <div class="tree-search-container">
                    <input type="search" id="tree-search-input" class="tree-search-input" placeholder="חפש במפתח או בערך...">
                    <button id="tree-search-btn" class="action-button tree-search-button">חפש</button>
                </div>
                <div id="tree-view" class="tree-view-container">
                    <p class="tree-placeholder">הצג תצוגת עץ כאן כאשר ה-JSON תקין.</p>
                </div>
            </div>
        </main>
        <footer class="app-footer">
            <div id="status-bar" class="status-bar status-idle">
                <div id="status-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width:1.5rem; height:1.5rem;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path>
                    </svg>
                </div>
                <p id="status-message">הדבק את ה-JSON שלך ובדוק את תקינותו, או נסה פורמט JSON Lines.</p>
            </div>
        </footer>
        <input type="file" id="file-input" accept=".json" hidden />
    </div>

    <div id="schema-editor-modal" class="modal-overlay" hidden>
        <div class="modal-content">
            <header class="modal-header">
                <h2 class="modal-title">עורך סכמות</h2>
                <button id="close-modal-btn" class="close-button" aria-label="Close modal">&times;</button>
            </header>
            <main class="modal-body">
                <div class="schema-editor-controls">
                    <select id="schema-edit-select" class="action-button schema-select" aria-label="Select schema to edit" title="בחר סכמה קיימת כדי לערוך אותה.">
                        <option value="">בחר סכמה לעריכה...</option>
                    </select>
                    <button id="create-new-schema-btn" class="action-button create-new-button" title="נקה את הטופס כדי ליצור סכמה חדשה מאפס.">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 1.25rem; height: 1.25rem;">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 10.5v6m3-3H9m4.06-7.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z" />
                        </svg>
                        <span>צור חדש</span>
                    </button>
                    <button id="upload-schema-btn" class="action-button upload-button" title="טען סכמת JSON מהמחשב">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 1.25rem; height: 1.25rem;">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"></path>
                        </svg>
                        <span>טען סכמה/גייסון</span>
                    </button>
                </div>
                <div id="schema-editor-form-container" hidden>
                    <div class="schema-form-grid">
                        <div class="form-group">
                            <label for="schema-title-input">כותרת הסכמה (Display Title)</label>
                            <input type="text" id="schema-title-input" class="schema-form-input" placeholder="e.g., My New Schema" title="יש להשתמש באותיות באנגלית, מספרים ורווחים בלבד." dir="ltr" pattern="[a-zA-Z0-9\s]*">
                        </div>
                        <div class="form-group">
                            <label for="schema-description-input">תיאור</label>
                            <input type="text" id="schema-description-input" class="schema-form-input" placeholder="לדוגמה: סכמה לבדיקת לוגים אפליקטיביים" title="תיאור קצר של מטרת הסכמה.">
                        </div>
                    </div>

                    <div class="schema-editor-main-area">
                         <div id="schema-raw-editor-container" class="visual-builder-column">
                            <div class="builder-header">
                                <h3 class="builder-title">תוכן הסכמה (JSON Schema)</h3>
                            </div>
                            <textarea id="schema-content-textarea" class="json-textarea schema-editor-textarea" spellcheck="false" dir="ltr" title="קוד המקור של הסכמה בפורמט JSON Schema."></textarea>
                        </div>
                        <div class="visual-builder-column">
                            <div class="builder-header">
                                <h3 class="builder-title">השדות</h3>
                                <button id="add-schema-field-btn" class="action-button add-field-button-main">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 1rem; height: 1rem;">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                    </svg>
                                    <span>הוסף שדה</span>
                                </button>
                            </div>
                            <div id="schema-visual-builder-container">
                                <div id="schema-fields-container">
                                    <!-- Dynamic field rows will be injected here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="schema-editor-feedback" class="feedback-display" hidden>
                         <div id="schema-editor-feedback-icon"></div>
                         <p id="schema-editor-feedback-message"></p>
                    </div>
                     <div id="schema-complexity-warning" class="feedback-display feedback-error" hidden>
                        <div id="schema-complexity-warning-icon"></div>
                        <p id="schema-complexity-warning-message"></p>
                    </div>
                </div>
            </main>
            <footer id="schema-editor-footer" class="modal-footer" hidden>
                <div style="flex-grow: 1;"></div>
                <button id="download-schema-btn" class="action-button download-button" title="שמור את הסכמה הנוכחית כקובץ JSON.">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 1.25rem; height: 1.25rem;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
                    </svg>
                    <span>שמור סכמה כקובץ</span>
                </button>
                <button id="save-schema-btn" class="action-button save-button" title="שומר את השינויים בסשן הנכחי בלבד.">שמור שינויים</button>
            </footer>
             <input type="file" id="schema-file-input" accept=".json" hidden />
        </div>
    </div>

    <div id="add-field-modal" class="modal-overlay" hidden>
        <form class="modal-content-small" id="add-field-form">
            <header class="modal-header">
                <h2 class="modal-title">הוספת שדה חדש</h2>
                 <button id="close-add-field-modal-btn" type="button" class="close-button" aria-label="Close modal">&times;</button>
            </header>
            <main class="modal-body-small">
                 <div class="form-group">
                    <label for="new-field-name">שם השדה</label>
                    <input type="text" id="new-field-name" class="schema-form-input" placeholder="e.g., firstName, age, isActive" required dir="ltr">
                </div>
                 <div class="form-group">
                    <label for="new-field-description">תיאור</label>
                    <input type="text" id="new-field-description" class="schema-form-input" placeholder="Describe the purpose of this field">
                </div>
                <div class="form-group">
                     <label>סוג השדה</label>
                     <div class="field-type-selector">
                        <label>
                            <input type="radio" name="fieldType" value="string" checked>
                            <div class="field-type-option" data-type="string" title="שדה טקסטואלי. לדוגמה: 'שלום עולם'.">Text</div>
                        </label>
                        <label>
                            <input type="radio" name="fieldType" value="number">
                            <div class="field-type-option" data-type="number" title="שדה מספרי שיכול להכיל מספרים שלמים או עשרוניים. לדוגמה: 10.5.">Number</div>
                        </label>
                        <label>
                            <input type="radio" name="fieldType" value="integer">
                            <div class="field-type-option" data-type="integer" title="שדה מספרי שיכול להכיל מספרים שלמים בלבד (ללא נקודה עשרונית). לדוגמה: 2024.">Integer</div>
                        </label>
                        <label>
                            <input type="radio" name="fieldType" value="boolean">
                            <div class="field-type-option" data-type="boolean" title="שדה בוליאני המייצג אמת או שקר (true/false).">Yes/No</div>
                        </label>
                         <label>
                            <input type="radio" name="fieldType" value="object">
                            <div class="field-type-option" data-type="object" title="אובייקט המכיל שדות נוספים (מבנה מקונן).">Object</div>
                        </label>
                         <label>
                            <input type="radio" name="fieldType" value="array">
                            <div class="field-type-option" data-type="array" title="מערך או רשימה של פריטים מאותו סוג.">List</div>
                        </label>
                     </div>
                </div>
                 <div class="form-group">
                    <label class="field-required-label" style="font-weight: normal; color: var(--text-color-light);">
                        <input type="checkbox" id="new-field-required" checked>
                        שדה חובה
                    </label>
                </div>
            </main>
            <footer class="modal-footer">
                <button type="button" id="cancel-add-field-btn" class="action-button download-button">ביטול</button>
                <button type="submit" class="action-button save-button">הוסף שדה</button>
            </footer>
        </form>
    </div>
    
    <template id="schema-field-template">
        <div class="schema-field-row" data-field-id="">
            <details>
                <summary class="field-summary">
                    <span class="field-toggle-icon" aria-hidden="true">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor" style="width: 0.8em; height: 0.8em;">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
                        </svg>
                    </span>
                    <div class="field-main">
                        <span class="field-name-display" title="לחץ כדי לערוך שם"></span>
                        <span class="field-description-display" title="לחץ כדי לערוך תיאור"></span>
                    </div>
                    <div class="field-controls">
                        <div class="field-type-select-wrapper">
                            <select class="field-type-select" aria-label="Field type">
                                <option value="string">Text</option>
                                <option value="number">Number</option>
                                <option value="integer">Integer</option>
                                <option value="boolean">Yes/No</option>
                                <option value="object">Object</option>
                                <option value="array">List</option>
                            </select>
                        </div>
                        <div class="field-required-control">
                            <input type="checkbox" class="field-required-checkbox" id="field-required-template-id">
                            <label for="field-required-template-id">נדרש</label>
                        </div>
                        <button class="delete-field-btn" aria-label="Delete field" title="מחק שדה">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 1.125rem; height: 1.125rem;"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.134-2.033-2.134H8.033C6.91 2.75 6 3.664 6 4.834v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" /></svg>
                        </button>
                    </div>
                </summary>
                <div class="field-details">
                    <div class="field-validations">
                        <!-- Validation inputs for number, string, etc., will be injected here -->
                    </div>
                    <div class="field-children-container" hidden>
                        <!-- Nested fields will be appended here -->
                    </div>
                     <div class="field-actions" hidden>
                        <!-- "Add Field" button for objects will be injected here -->
                    </div>
                </div>
            </details>
        </div>
    </template>

    <script src="./index.js" defer></script>
</body>
</html>